language: haskell
notifications:
  email:
    - cg.wowus.cg@gmail.com
  on_success: always
  on_failure: always

before_install:
    - ls -lah /lib/ghc/bin
    - cabal sandbox init
    - cabal install -j --only-dependencies --enable-tests --enable-benchmarks --with-hsc2hs=/usr/bin/hsc2hs

install:
    - cabal configure --enable-tests --enable-benchmarks -O2 --with-haddock=/lib/ghc/bin/haddock
    - cabal build

script:
    - cabal test -j --show-details=failures --test-options="-j 16 -a 100000 +RTS -N"
    - cabal bench || true
    - cabal haddock
